Ok I need these things:

1) Adapter concept thingy

  Needs a name and index
  Current IP address etc
  interface_info

  Must be able to get one from an adapter index or name
  Must query the ip address and such
  Must be able to set the address

2) System state doodad

  List of adapters
  List of parameter changes
  List of persistent stuff
  
  Must be able to initialize from the registry 
  (persistent stuff, some adapter info)
  Save changes to persistent set

3) Parameter change set

  TODO  

4) Persistent queries

  TODO