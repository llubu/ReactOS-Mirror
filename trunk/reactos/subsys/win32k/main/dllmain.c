/* $Id: dllmain.c,v 1.11 2000/02/20 22:52:50 ea Exp $
 * 
 *  Entry Point for win32k.sys
 */

#undef WIN32_LEAN_AND_MEAN
#define WIN32_NO_STATUS
#include <windows.h>
#include <ddk/ntddk.h>
#include <ddk/winddi.h>
#include <internal/service.h>
#include <internal/hal.h>

#include <win32k/win32k.h>

/*
 * NOTE: the table is actually in the file ./svctab.c,
 * generated by iface/addsys/mktab.c + w32ksvc.db
 */
#include "svctab.c"

/*
 * This definition doesn't work
 */
// WINBOOL STDCALL DllMain(VOID)
NTSTATUS
STDCALL
DllMain (
	IN	PDRIVER_OBJECT	DriverObject,
	IN	PUNICODE_STRING	RegistryPath
	)
{
	NTSTATUS	Status;
  
	/*
	 * Register user mode call interface
	 * (svc mask is 0x10000000)
	 */
	Status = HalRegisterServiceTable (
			0xF0000000, 
			0x10000000, 
			W32kServiceTable,
			sizeof (W32kServiceTable)
                        / sizeof(W32kServiceTable[0])
			);
	if (!NT_SUCCESS(Status))
	{
		return FALSE;
	}
  
	return TRUE;
}


/* EOF */
